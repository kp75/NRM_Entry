// Generated by Selenium IDE
import org.junit.Test;
import org.junit.Before;
import org.apache.commons.io.FileUtils;
import org.junit.After;
import org.junit.Assert;

import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.core.IsNot.not;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.firefox.FirefoxOptions;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.Dimension;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.remote.DesiredCapabilities;
import org.openqa.selenium.safari.SafariDriver;
import org.openqa.selenium.safari.SafariOptions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import com.assertthat.selenium_shutterbug.core.Shutterbug;
import com.assertthat.selenium_shutterbug.utils.web.ScrollStrategy;

import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Alert;
import org.openqa.selenium.Keys;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;

import java.util.HashMap;
import java.util.List;
import java.io.File;
import java.io.FileWriter;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.Map;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
public class ReferralEntry {
  private static WebDriver driver;
  private Map<String, Object> vars;
  JavascriptExecutor js;

	public static final String Path_Screenshots = System.getProperty("user.dir") + "\\";//path for screenshots
	public static String fileSeparator = System.getProperty("file.separator");//used by the screenshot method below
	public static Date date = new Date();//sets a constant test start date to be used in html reports and screenshots folder
	public static DateFormat dateFormat = new SimpleDateFormat("ddMMyy_HHmmss");
	public static DateFormat dateFormat2 = new SimpleDateFormat("ddMMyy");
	public static DateFormat dateFormat3 = new SimpleDateFormat("HHmmss");
	
	//referral fields by screen
    //FRLocation
    private static String frloc;//to be defined in data spreadsheet
    //Under18
    private static String over18 = "pv-under-age-no";
    private static String under18 = "pv-under-age-yes";
    private static String notsure18 = "pv-under-age-not-sure";
    //Local authority info for child referrals
    private static String localauthority = "local-authority-contacted-about-child-local-authority-name";
    private static String laphone = "local-authority-contacted-about-child-local-authority-phone";
    private static String laemail = "local-authority-contacted-about-child-local-authority-email";
    private static String lafirstname = "local-authority-contacted-about-child-local-authority-first-name";
    private static String lalastname = "local-authority-contacted-about-child-local-authority-last-name";
    //Under18atExploit
    private static String over18ex = "pv-under-age-at-time-of-exploitation-no";
    private static String under18ex = "pv-under-age-at-time-of-exploitation-yes";
    private static String notsure18ex = "pv-under-age-at-time-of-exploitation-not-sure";
    //VictimAccount
    private static String account = "what-happened";
    //Where
    private static String whereuk = "where-exploitation-happened-uk";
    private static String whereukcity = "where-exploitation-happened-uk-city-1";
    private static String whereukcity2 = "where-exploitation-happened-uk-city-2";
    private static String whereukcity3 = "where-exploitation-happened-uk-city-3";
    private static String whereukcity4 = "where-exploitation-happened-uk-city-4";
    private static String whereukcity5 = "where-exploitation-happened-uk-city-5";
    private static String whereukcity6 = "where-exploitation-happened-uk-city-6";
    private static String whereukcity7 = "where-exploitation-happened-uk-city-7";
    private static String whereukcity8 = "where-exploitation-happened-uk-city-8";
    private static String whereukcity9 = "where-exploitation-happened-uk-city-9";
    private static String whereukcity10 = "where-exploitation-happened-uk-city-10";
    //private static String whereukregion = "where-exploitation-happened-uk-region";
    private static String whereukother = "where-exploitation-happened-other-uk-other-location";
    private static String wherenonuk = "where-exploitation-happened-overseas";
    private static String wherecountry = "where-exploitation-happened-overseas-country-1";
    private static String wherecountry2 = "where-exploitation-happened-overseas-country-2";
    private static String wherecountry3 = "where-exploitation-happened-overseas-country-3";
    private static String wherecountry4 = "where-exploitation-happened-overseas-country-4";
    private static String wherecountry5 = "where-exploitation-happened-overseas-country-5";
    private static String wherecountry6 = "where-exploitation-happened-overseas-country-6";
    private static String wherecountry7 = "where-exploitation-happened-overseas-country-7";
    private static String wherecountry8 = "where-exploitation-happened-overseas-country-8";
    private static String wherecountry9 = "where-exploitation-happened-overseas-country-9";
    private static String wherecountry10 = "where-exploitation-happened-overseas-country-10";
    private static String wherenonukother = "where-exploitation-happened-other-overseas-other-location";
    private static String whereboth = "where-exploitation-happened-uk-and-overseas";
    //currentLocation
    private static String currentukcity = "current-pv-location-uk-city";
    private static String currentukregion = "current-pv-location-uk-region";
    //Exploiter
    private static String whoex = "who-exploited-pv";
    //Exploitation
    private static String forcework = "types-of-exploitation-forced-to-work";
    private static String wagestaken = "types-of-exploitation-wages-taken";
    private static String commitfraud = "types-of-exploitation-forced-to-commit-fraud";
    private static String prostitution = "types-of-exploitation-prostitution";
    private static String childexp = "types-of-exploitation-child-exploitation";
    private static String taken = "types-of-exploitation-taken-somewhere";
    private static String commitcrime = "types-of-exploitation-forced-to-commit-crime";
    private static String organs = "types-of-exploitation-organs-removed";
    private static String unpaid = "types-of-exploitation-unpaid-household-work";
    private static String other = "types-of-exploitation-other";
    private static String otherdetails = "other-exploitation-details";
    //OtherPV
    private static String otherpv = "any-other-pvs-yes";
    private static String nootherpv = "any-other-pvs-no";
    private static String notsureotherpv = "any-other-pvs-not-sure";
    //PoliceReport
    private static String policeno = "reported-to-police-no";
    private static String policeyes = "reported-to-police-yes";
    private static String policeforce = "reported-to-police-police-forces";
    private static String crimeref = "reported-to-police-crime-reference";
    //NRMorDtN
    private static String nrmyes = "pv-want-to-submit-nrm-yes";
    private static String nrmno = "pv-want-to-submit-nrm-no";
    //No NRM reason
    private static String nonrmreason = "refuse-nrm";
    //PVSupport
    private static String support = "does-pv-need-support-yes";
    private static String nosupport = "does-pv-need-support-no";
    //PVName
    private static String pvfirst = "pv-name-first-name";
    private static String pvlast = "pv-name-last-name";
    private static String pvalias = "pv-name-nickname";
    //PVDoB
    private static String dobday = "pv-dob-day";
    private static String dobmonth = "pv-dob-month";
    private static String dobyear = "pv-dob-year";
    //PVGender
    private static String male = "pv-gender-male";
    private static String female = "pv-gender-female";
    private static String unknown = "pv-gender-unknown";
    //PVChildren;
    private static String nochildren = "does-pv-have-children-no";
    private static String children = "does-pv-have-children-yes";
    private static String childamount = "does-pv-have-children-yes-amount";
    //PVNationality
    private static String nationality = "pv-nationality";
    private static String nationality2 = "pv-nationality-second";
    //PVInterpreter
    private static String nointerpreter = "pv-interpreter-requirements-no";
    private static String interpreter = "pv-interpreter-requirements-yes";
    private static String language = "pv-interpreter-requirements-language";
    //Communication
    private static String nocommaid = "pv-other-help-with-communication-no";
    private static String commaid = "pv-other-help-with-communication-yes";
    private static String aidtype = "pv-other-help-with-communication-aid";
    //HORef
    private static String nohoref = "pv-ho-reference-no";
    private static String horef = "pv-ho-reference-yes";
    private static String horefnum = "pv-ho-reference-type";
    //DecisionContact
    private static String pvcontact = "who-contact-potential-victim";
    private static String othercontact = "who-contact-someone-else";
    //PVDetails
    private static String pvsendemail = "pv-contact-details-email";
    private static String pvemail = "pv-contact-details-email-input";
    private static String pvemailsafe = "pv-contact-details-email-check";
    private static String pvsendpost = "pv-contact-details-post";
    private static String pvstreet = "pv-contact-details-street";
    private static String pvtown = "pv-contact-details-town";
    private static String pvcounty = "pv-contact-details-county";
    private static String pvpostcode = "pv-contact-details-postcode";
    private static String pvpostsafe = "pv-contact-details-post-check";
    //Someone else details
    private static String sefirstname = "someone-else-first-name";
    private static String selastname = "someone-else-last-name";
    private static String sesendemail = "someone-else-email";
    private static String seemail = "someone-else-email-input";
    private static String sesendpost = "someone-else-post";
    private static String sestreet = "someone-else-street";
    private static String setown = "someone-else-town";
    private static String secounty = "someone-else-county";
    private static String sepostcode = "someone-else-postcode";
    private static String pvpermission = "someone-else-permission-check";    
    //Phone
    private static String nopvphone = "pv-phone-number-no";
    private static String pvphone = "pv-phone-number-yes";
    private static String pvnumber = "pv-phone-number-yes";
    //Consent
    private static String consent = "co-operate-with-police-yes";
    private static String noconsent = "co-operate-with-police-no";
    //FRDetails
    private static String frfirst = "fr-details-first-name";
    private static String frlast = "fr-details-last-name";
    private static String frrole = "fr-details-role";
    private static String frphone = "fr-details-phone";
    //Alternate
    private static String alternate = "fr-alternative-contact";
    //check your answers
    //private static String cyatitle= "Check your answers - GOV.UK";
    //referral submission success
    //private static String subcomp= "- GOV.UK";
    String projectName = "MS_Test";
    String screenName;
    String testResult;
    String logFile = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date);
    
	
  //@Before
  //public void setUp() {
	//System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
    //driver = new ChromeDriver();
    //js = (JavascriptExecutor) driver;
    //vars = new HashMap<String, Object>();
    
  //}
 @After
  public void tearDown() {
    driver.quit();
  }
//    
  @Test
  public void adult1() throws Exception {
	
 	
	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "adult1");
	//int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	//System.out.println("rowcount " + rowNumbers + " last column " + columnLast + "test name" + testName);
	//String columnResult = dateFormat.format(date);
	//ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.gecko.driver", "/Users/Bean/Desktop/Selenium/geckodriver");
			FirefoxOptions firefoxOptions = new FirefoxOptions();
		    firefoxOptions.setCapability("marionette", true);
		    driver = new FirefoxDriver(firefoxOptions);		
		    String testName = "Adult1." + line + "Firefox";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
		    
		    
		    
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String saccount = ExcelUtil.getCellData(line, 3);
			String sukcity = ExcelUtil.getCellData(line, 4);
			String sukother = ExcelUtil.getCellData(line, 5);
			String scurrentukcity = ExcelUtil.getCellData(line, 6);
			String scurrentukregion = ExcelUtil.getCellData(line, 7);
			String swhoex = ExcelUtil.getCellData(line, 8);
			String sotherdetails = ExcelUtil.getCellData(line, 9);
			String spoliceforce = ExcelUtil.getCellData(line, 10);
			String scrimeref = ExcelUtil.getCellData(line, 11);
			String spvfirst = ExcelUtil.getCellData(line, 12);
			String spvlast = ExcelUtil.getCellData(line, 13);
			String spvalias = ExcelUtil.getCellData(line, 14);
			String sdobday = ExcelUtil.getCellData(line, 15);
			String sdobmonth = ExcelUtil.getCellData(line, 16);
			String sdobyear = ExcelUtil.getCellData(line, 17);
			String schildamount = ExcelUtil.getCellData(line, 18);
			String snationality = ExcelUtil.getCellData(line, 19);
			String slanguage = ExcelUtil.getCellData(line, 20);
			String saidtype = ExcelUtil.getCellData(line, 21);
			String shorefnum = ExcelUtil.getCellData(line, 22);
			String spvemail = ExcelUtil.getCellData(line, 23);
			String spvstreet = ExcelUtil.getCellData(line, 24);
			String spvtown= ExcelUtil.getCellData(line, 25);
			String spvcounty = ExcelUtil.getCellData(line, 26);
			String spvpostcode = ExcelUtil.getCellData(line, 27);
			String spvnumber = ExcelUtil.getCellData(line, 28);
			String sfrfirst = ExcelUtil.getCellData(line, 29);
			String sfrlast = ExcelUtil.getCellData(line, 30);
			String sfrrole = ExcelUtil.getCellData(line, 31);
			String sfrphone = ExcelUtil.getCellData(line, 32);
			String salternate = ExcelUtil.getCellData(line, 33);
			
		    
			try{
			screenName = "1 - Start";
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(over18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-Under18atExploit";
		    driver.findElement(By.id(over18ex)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(whereuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-Whereuk";
		    driver.findElement(By.id(whereukcity)).sendKeys(sukcity);
		    driver.findElement(By.id(whereukother)).sendKeys(sukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(commitfraud)).click();
		    driver.findElement(By.id(organs)).click();
		    driver.findElement(By.id(prostitution)).click();
		    driver.findElement(By.id(other)).click();
		    driver.findElement(By.id(otherdetails)).sendKeys(sotherdetails);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(nootherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "12-NRMorDtN";
		    driver.findElement(By.id(nrmyes)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVSupport";
		    driver.findElement(By.id(support)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVName";
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVDoB";
		    driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVGender";
		    driver.findElement(By.id(female)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVChildren";
		    driver.findElement(By.id(children)).click();
		    driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
            //driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-PVInterpreter";
		    driver.findElement(By.id(interpreter)).click();
		    driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-Communication";
		    driver.findElement(By.id(commaid)).click();
		    driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21-HORef";
		    driver.findElement(By.id(nohoref)).click();
		    //driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21.1-DecisionContact";
		    driver.findElement(By.id(pvcontact)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22-PVDetails";
		    driver.findElement(By.id(pvsendemail)).click();
		    driver.findElement(By.id(pvemail)).sendKeys(spvemail);
		    driver.findElement(By.id(pvemailsafe)).click();
		    driver.findElement(By.id(pvsendpost)).click();
		    driver.findElement(By.id(pvstreet)).sendKeys(spvstreet);
		    driver.findElement(By.id(pvtown)).sendKeys(spvtown);
		    driver.findElement(By.id(pvcounty)).sendKeys(spvcounty);
		    driver.findElement(By.id(pvpostcode)).sendKeys(spvpostcode);
		    driver.findElement(By.id(pvpostsafe)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Phone";
		    driver.findElement(By.id(pvphone)).click();
		    driver.findElement(By.name(pvnumber)).sendKeys(spvnumber);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-Consent";
		    driver.findElement(By.id(consent)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "26-FRDetails";
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "27-Alternate";
		    driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "28-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "29-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    
		    	  System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
		    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
			      testResult = (testName + " - Submission completed correctly");
		    	  System.out.println(testResult);
		    	  Utility.Utilitylog(logFile, testResult);
			    }
			    catch(Throwable pageNavigationError){
			      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
			      testResult = (testName + " - Submission did not complete correctly");
			      System.out.println(testResult);
			      Utility.Utilitylog(logFile, testResult);
			    
			    }
		    
		    
		    driver.quit();
		   
		}
	 }
   @Test
  public void adult2() throws Exception {
    String projectName = "MS_Test";
    String screenName;
 	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "adult2");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
		    driver = new ChromeDriver();
		    js = (JavascriptExecutor) driver;
		    vars = new HashMap<String, Object>();		
		    String testName = "Adult2." + line + "Chrome";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String saccount = ExcelUtil.getCellData(line, 3);
			String sukcity = ExcelUtil.getCellData(line, 4);
			String sukcity2 = ExcelUtil.getCellData(line, 5);
			String sukcity3 = ExcelUtil.getCellData(line, 6);
			String sukcity4 = ExcelUtil.getCellData(line, 7);
			String sukcity5 = ExcelUtil.getCellData(line, 8);
			String sukcity6 = ExcelUtil.getCellData(line, 9);
			String sukcity7 = ExcelUtil.getCellData(line, 10);
			String sukcity8 = ExcelUtil.getCellData(line, 11);
			String sukcity9 = ExcelUtil.getCellData(line, 12);
			String sukcity10 = ExcelUtil.getCellData(line, 13);
			String sukother = ExcelUtil.getCellData(line, 14);
			String swherecountry = ExcelUtil.getCellData(line, 15);
			String swherecountry2 = ExcelUtil.getCellData(line, 16);
			String swherecountry3 = ExcelUtil.getCellData(line, 17);
			String swherecountry4 = ExcelUtil.getCellData(line, 18);
			String swherecountry5 = ExcelUtil.getCellData(line, 19);
			String swherecountry6 = ExcelUtil.getCellData(line, 20);
			String swherecountry7 = ExcelUtil.getCellData(line, 21);
			String swherecountry8 = ExcelUtil.getCellData(line, 22);
			String swherecountry9 = ExcelUtil.getCellData(line, 23);
			String swherecountry10 = ExcelUtil.getCellData(line, 24);
			String swherenonukother = ExcelUtil.getCellData(line, 25);
			String scurrentukcity = ExcelUtil.getCellData(line, 26);
			String scurrentukregion = ExcelUtil.getCellData(line, 27);
			String swhoex = ExcelUtil.getCellData(line, 28);
			String sotherdetails = ExcelUtil.getCellData(line, 29);
			String spoliceforce = ExcelUtil.getCellData(line, 30);
			String scrimeref = ExcelUtil.getCellData(line, 31);
			String spvfirst = ExcelUtil.getCellData(line, 32);
			String spvlast = ExcelUtil.getCellData(line, 33);
			String spvalias = ExcelUtil.getCellData(line, 34);
			String sdobday = ExcelUtil.getCellData(line, 35);
			String sdobmonth = ExcelUtil.getCellData(line, 36);
			String sdobyear = ExcelUtil.getCellData(line, 37);
			String schildamount = ExcelUtil.getCellData(line, 38);
			String snationality = ExcelUtil.getCellData(line, 39);
			String snationality2 = ExcelUtil.getCellData(line, 40);
			String slanguage = ExcelUtil.getCellData(line, 41);
			String saidtype = ExcelUtil.getCellData(line, 42);
			String shorefnum = ExcelUtil.getCellData(line, 43);
			String ssefirstname = ExcelUtil.getCellData(line, 44);
			String sselastname = ExcelUtil.getCellData(line, 45);
			String sseemail = ExcelUtil.getCellData(line, 46);
			String ssestreet = ExcelUtil.getCellData(line, 47);
			String ssetown= ExcelUtil.getCellData(line, 48);
			String ssecounty = ExcelUtil.getCellData(line, 49);
			String ssepostcode = ExcelUtil.getCellData(line, 50);
			String spvnumber = ExcelUtil.getCellData(line, 51);
			String sfrfirst = ExcelUtil.getCellData(line, 52);
			String sfrlast = ExcelUtil.getCellData(line, 53);
			String sfrrole = ExcelUtil.getCellData(line, 54);
			String sfrphone = ExcelUtil.getCellData(line, 55);
			String salternate = ExcelUtil.getCellData(line, 56);
			
		    
		try {
			screenName = "1-Start";
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(over18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-Under18atExploit";
		    driver.findElement(By.id(under18ex)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(whereboth)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-Whereuk";
		    driver.findElement(By.id(whereukcity)).sendKeys(sukcity);
		    driver.findElement(By.id(whereukcity2)).sendKeys(sukcity2);
		    driver.findElement(By.id(whereukcity3)).sendKeys(sukcity3);
		    driver.findElement(By.id(whereukcity4)).sendKeys(sukcity4);
		    driver.findElement(By.id(whereukcity5)).sendKeys(sukcity5);
		    driver.findElement(By.id(whereukcity6)).sendKeys(sukcity6);
		    driver.findElement(By.id(whereukcity7)).sendKeys(sukcity7);
		    driver.findElement(By.id(whereukcity8)).sendKeys(sukcity8);
		    driver.findElement(By.id(whereukcity9)).sendKeys(sukcity9);
		    driver.findElement(By.id(whereukcity10)).sendKeys(sukcity10);
		    driver.findElement(By.id(whereukother)).sendKeys(sukother);
	        Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.2-WhereOverseas";
		    driver.findElement(By.id(wherecountry)).sendKeys(swherecountry);
		    driver.findElement(By.id(wherecountry2)).sendKeys(swherecountry2);
		    driver.findElement(By.id(wherecountry3)).sendKeys(swherecountry3);
		    driver.findElement(By.id(wherecountry4)).sendKeys(swherecountry4);
		    driver.findElement(By.id(wherecountry5)).sendKeys(swherecountry5);
		    driver.findElement(By.id(wherecountry6)).sendKeys(swherecountry6);
		    driver.findElement(By.id(wherecountry7)).sendKeys(swherecountry7);
		    driver.findElement(By.id(wherecountry8)).sendKeys(swherecountry8);
		    driver.findElement(By.id(wherecountry9)).sendKeys(swherecountry9);
		    driver.findElement(By.id(wherecountry10)).sendKeys(swherecountry10);
		    driver.findElement(By.id(wherenonukother)).sendKeys(swherenonukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(forcework)).click();
		    driver.findElement(By.id(wagestaken)).click();
		    driver.findElement(By.id(commitfraud)).click();
		    driver.findElement(By.id(prostitution)).click();
		    driver.findElement(By.id(childexp)).click();
		    driver.findElement(By.id(taken)).click();
		    driver.findElement(By.id(commitcrime)).click();
		    driver.findElement(By.id(organs)).click();
		    driver.findElement(By.id(unpaid)).click();
		    driver.findElement(By.id(other)).click();
		    driver.findElement(By.id(otherdetails)).sendKeys(sotherdetails); 
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(otherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "12-NRMorDtN";
		    driver.findElement(By.id(nrmyes)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVSupport";
		    driver.findElement(By.id(support)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVName";
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVDoB";
		    driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVGender";
		    driver.findElement(By.id(male)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVChildren";
		    driver.findElement(By.id(children)).click();
		    driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
    		//driver.findElement(By.xpath("//span/div/div/div")).click();
   		    //driver.findElement(By.xpath("//summary/span")).click();
   	        driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-PVInterpreter";
		    driver.findElement(By.id(interpreter)).click();
		    driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-Communication";
		    driver.findElement(By.id(commaid)).click();
		    driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21-HORef";
		    driver.findElement(By.id(horef)).click();
		    driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21.1-DecisionContact";
		    driver.findElement(By.id(othercontact)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22.1-PVSEDetails";
		    driver.findElement(By.id(sefirstname)).sendKeys(ssefirstname);
		    driver.findElement(By.id(selastname)).sendKeys(sselastname);
		    driver.findElement(By.id(sesendemail)).click();
		    driver.findElement(By.id(seemail)).sendKeys(sseemail);
		    driver.findElement(By.id(sesendpost)).click();
		    driver.findElement(By.id(sestreet)).sendKeys(ssestreet);
		    driver.findElement(By.id(setown)).sendKeys(ssetown);
		    driver.findElement(By.id(secounty)).sendKeys(ssecounty);
		    driver.findElement(By.id(sepostcode)).sendKeys(ssepostcode);
		    driver.findElement(By.id(pvpermission)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Phone";
		    driver.findElement(By.id(pvphone)).click();
		    driver.findElement(By.name(pvnumber)).sendKeys(spvnumber);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-Consent";
		    driver.findElement(By.id(noconsent)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "26-FRDetails";
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "27-Alternate";
		    driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "28-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "29-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    
		    driver.quit();
		   
		}
	 }  
  
  @Test
  public void adult3() throws Exception {
	String projectName = "MS_Test";
    String screenName;
 	
	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "adult3");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	//System.out.println("rowcount " + rowNumbers + " last column " + columnLast + "test name" + testName);
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
		    driver = new ChromeDriver();
		    js = (JavascriptExecutor) driver;
		    vars = new HashMap<String, Object>();	
		    String testName = "Adult3." + line + "Chrome";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String saccount = ExcelUtil.getCellData(line, 3);
			String sukcity = ExcelUtil.getCellData(line, 4);
			String scurrentukcity = ExcelUtil.getCellData(line, 5);
			String scurrentukregion = ExcelUtil.getCellData(line, 6);
			String swhoex = ExcelUtil.getCellData(line, 7);
			String spoliceforce = ExcelUtil.getCellData(line, 8);
			String scrimeref = ExcelUtil.getCellData(line, 9);
			String spvfirst = ExcelUtil.getCellData(line, 10);
			String spvlast = ExcelUtil.getCellData(line, 11);
			String spvalias = ExcelUtil.getCellData(line, 12);
			String sdobday = ExcelUtil.getCellData(line, 13);
			String sdobmonth = ExcelUtil.getCellData(line, 14);
			String sdobyear = ExcelUtil.getCellData(line, 15);
			String schildamount = ExcelUtil.getCellData(line, 16);
			String snationality = ExcelUtil.getCellData(line, 17);;
			String slanguage = ExcelUtil.getCellData(line, 18);
			String saidtype = ExcelUtil.getCellData(line, 19);
			String shorefnum = ExcelUtil.getCellData(line, 20);
			String spvemail = ExcelUtil.getCellData(line, 21);
			String spvstreet = ExcelUtil.getCellData(line, 22);
			String spvtown= ExcelUtil.getCellData(line, 23);
			String spvcounty = ExcelUtil.getCellData(line, 24);
			String spvpostcode = ExcelUtil.getCellData(line, 25);
			String spvnumber = ExcelUtil.getCellData(line, 26);
			String sfrfirst = ExcelUtil.getCellData(line, 27);
			String sfrlast = ExcelUtil.getCellData(line, 28);
			String sfrrole = ExcelUtil.getCellData(line, 29);
			String sfrphone = ExcelUtil.getCellData(line, 30);
			String salternate = ExcelUtil.getCellData(line, 31);
			
		    
		try {
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    Thread.sleep(1000);
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    Thread.sleep(1000);
		    driver.findElement(By.id(over18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-Under18atExploit";
		    Thread.sleep(1000);
		    driver.findElement(By.id(notsure18ex)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    Thread.sleep(1000);
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    Thread.sleep(1000);
		    driver.findElement(By.id(whereuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-Whereuk";
		    driver.findElement(By.id(whereukcity)).sendKeys(sukcity);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    Thread.sleep(1000);
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    Thread.sleep(1000);
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    Thread.sleep(1000);
		    driver.findElement(By.id(taken)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nootherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    Thread.sleep(1000);
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "12-NRMorDtN";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nrmyes)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVSupport";
		    Thread.sleep(1000);
		    driver.findElement(By.id(support)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVName";
		    Thread.sleep(1000);
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    //driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVDoB";
		    Thread.sleep(1000);
		    //driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    //driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    //driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVGender";
		    Thread.sleep(1000);
		    driver.findElement(By.id(unknown)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVChildren";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nochildren)).click();
		    //driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVNationality";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
 		    //driver.findElement(By.xpath("//span/div/div/div")).click();
  	        //driver.findElement(By.xpath("//summary/span")).click();
  	        //driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-PVInterpreter";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nointerpreter)).click();
		    //driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-Communication";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nocommaid)).click();
		    //driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21-HORef";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nohoref)).click();
		    //driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "21.1-DecisionContact";
		    Thread.sleep(1000);
		    driver.findElement(By.id(pvcontact)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22-PVDetails";
		    Thread.sleep(1000);
		    driver.findElement(By.id(pvsendemail)).click();
		    driver.findElement(By.id(pvemail)).sendKeys(spvemail);
		    driver.findElement(By.id(pvemailsafe)).click();
		    //driver.findElement(By.id(pvsendpost)).click();
		    //driver.findElement(By.id(pvstreet)).sendKeys(spvstreet);
		    //driver.findElement(By.id(pvtown)).sendKeys(spvtown);
		    //driver.findElement(By.id(pvcounty)).sendKeys(spvcounty);
		    //driver.findElement(By.id(pvpostcode)).sendKeys(spvpostcode);
		    //driver.findElement(By.id(pvpostsafe)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Phone";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nopvphone)).click();
		    //driver.findElement(By.name(pvnumber)).sendKeys(spvnumber);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-Consent";
		    Thread.sleep(1000);
		    driver.findElement(By.id(consent)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "26-FRDetails";
		    Thread.sleep(1000);
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "27-Alternate";
		    Thread.sleep(1000);
		    //driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "28-CYA";
    		Thread.sleep(3000);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "29-subcomplete";
            Thread.sleep(3000);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    
		    driver.quit();
		   
		}
	 }
  
    @Test
    public void dtn1() throws Exception {
    String projectName = "MS_Test";
    String screenName;
 	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "DtN1");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
		    driver = new ChromeDriver();
		    js = (JavascriptExecutor) driver;
		    vars = new HashMap<String, Object>();		
		    String testName = "DtN1." + line + "Chrome";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String saccount = ExcelUtil.getCellData(line, 3);
			String swherecountry = ExcelUtil.getCellData(line, 4);
			String swherenonukother = ExcelUtil.getCellData(line, 5);
			String scurrentukcity = ExcelUtil.getCellData(line, 6);
			String scurrentukregion = ExcelUtil.getCellData(line, 7);
			String swhoex = ExcelUtil.getCellData(line, 8);
			String sotherdetails = ExcelUtil.getCellData(line, 9);
			String spoliceforce = ExcelUtil.getCellData(line, 10);
			String scrimeref = ExcelUtil.getCellData(line, 11);
			String snonrmreason = ExcelUtil.getCellData(line, 12);
			String snationality = ExcelUtil.getCellData(line, 13);
			//String snationality2 = ExcelUtil.getCellData(line, 14);
			String spvfirst = ExcelUtil.getCellData(line, 15);
			String spvlast = ExcelUtil.getCellData(line, 16);
			String spvalias = ExcelUtil.getCellData(line, 17);
			String spvemail = ExcelUtil.getCellData(line, 18);
			String spvstreet = ExcelUtil.getCellData(line, 19);
			String spvtown= ExcelUtil.getCellData(line, 20);
			String spvcounty = ExcelUtil.getCellData(line, 21);
			String spvpostcode = ExcelUtil.getCellData(line, 22);
			
		    
			try{
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(over18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-Under18atExploit";
		    driver.findElement(By.id(under18ex)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(wherenonuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-WhereOverseas";
		    driver.findElement(By.id(wherecountry)).sendKeys(swherecountry);
		    driver.findElement(By.id(wherenonukother)).sendKeys(swherenonukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(organs)).click(); 
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(nootherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "12-NRMorDtN";
		    driver.findElement(By.id(nrmno)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-reasonnonrm";
		    driver.findElement(By.id(nonrmreason)).sendKeys(snonrmreason);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13.1-PVGender";
		    driver.findElement(By.id(male)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13.2-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
    		//driver.findElement(By.xpath("//span/div/div/div")).click();
    		//driver.findElement(By.xpath("//summary/span")).click();
    		//driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-Consent";
		    driver.findElement(By.id(noconsent)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
//		    screenName = "15-PVName";
//		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
//		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
//		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
//		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
//		    driver.findElement(By.cssSelector(".button")).click();
		     
//		    screenName = "16-PVSEDetails";
//		    driver.findElement(By.id(pvsendemail)).click();
//		    driver.findElement(By.id(pvemail)).sendKeys(spvemail);
//		    driver.findElement(By.id(pvemailsafe)).click();
//		    //driver.findElement(By.id(pvsendpost)).click();
//		    //driver.findElement(By.id(pvstreet)).sendKeys(spvstreet);
//		    //driver.findElement(By.id(pvtown)).sendKeys(spvtown);
//		    //driver.findElement(By.id(pvcounty)).sendKeys(spvcounty);
//		    //driver.findElement(By.id(pvpostcode)).sendKeys(spvpostcode);
//		    //driver.findElement(By.id(pvpostsafe)).click();
//		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
//		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "18-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("Duty to Notify (DtN) sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    driver.quit();
		   
		}
	 }  
  
  @Test
  public void dtn2() throws Exception {
    String projectName = "MS_Test";
    String screenName;
 	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "DtN2");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.gecko.driver", "/Users/Bean/Desktop/Selenium/geckodriver");
			FirefoxOptions firefoxOptions = new FirefoxOptions();
		    firefoxOptions.setCapability("marionette", true);
		    driver = new FirefoxDriver(firefoxOptions);		
		    String testName = "DtN2." + line + "Firefox";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
		
			//define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String saccount = ExcelUtil.getCellData(line, 3);
			String sukcity = ExcelUtil.getCellData(line, 4);
			String sukother = ExcelUtil.getCellData(line, 5);
			String scurrentukcity = ExcelUtil.getCellData(line, 6);
			String scurrentukregion = ExcelUtil.getCellData(line, 7);
			String swhoex = ExcelUtil.getCellData(line, 8);
			String sotherdetails = ExcelUtil.getCellData(line, 9);
			String spoliceforce = ExcelUtil.getCellData(line, 10);
			String scrimeref = ExcelUtil.getCellData(line, 11);
			String snonrmreason = ExcelUtil.getCellData(line, 12);
			String snationality = ExcelUtil.getCellData(line, 13);
			String snationality2 = ExcelUtil.getCellData(line, 14);
			String spvfirst = ExcelUtil.getCellData(line, 15);
			String spvlast = ExcelUtil.getCellData(line, 16);
			String spvalias = ExcelUtil.getCellData(line, 17);
			String spvemail = ExcelUtil.getCellData(line, 18);
			String spvstreet = ExcelUtil.getCellData(line, 19);
			String spvtown= ExcelUtil.getCellData(line, 20);
			String spvcounty = ExcelUtil.getCellData(line, 21);
			String spvpostcode = ExcelUtil.getCellData(line, 22);
			
		    
		try{
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(over18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-Under18atExploit";
		    driver.findElement(By.id(over18ex)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(whereuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-WhereUK";
		    driver.findElement(By.id(whereukcity)).sendKeys(sukcity);
		    driver.findElement(By.id(whereukother)).sendKeys(sukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(forcework)).click();
		    driver.findElement(By.id(wagestaken)).click();
		    driver.findElement(By.id(taken)).click();
		    driver.findElement(By.id(other)).click();
		    driver.findElement(By.id(otherdetails)).sendKeys(sotherdetails); 
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(nootherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "12-NRMorDtN";
		    driver.findElement(By.id(nrmno)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-reasonnonrm";
		    //driver.findElement(By.id(nonrmreason)).sendKeys(snonrmreason);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13.1-PVGender";
		    driver.findElement(By.id(female)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13.2-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
		    //driver.findElement(By.xpath("//span/div/div/div")).click();
		    //driver.findElement(By.xpath("//summary/span")).click();
		    driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-Consent";
		    driver.findElement(By.id(consent)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVName";
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		     
		    screenName = "16-PVSEDetails";
		    driver.findElement(By.id(pvsendemail)).click();
		    driver.findElement(By.id(pvemail)).sendKeys(spvemail);
		    driver.findElement(By.id(pvemailsafe)).click();
		    driver.findElement(By.id(pvsendpost)).click();
		    driver.findElement(By.id(pvstreet)).sendKeys(spvstreet);
		    driver.findElement(By.id(pvtown)).sendKeys(spvtown);
		    driver.findElement(By.id(pvcounty)).sendKeys(spvcounty);
		    driver.findElement(By.id(pvpostcode)).sendKeys(spvpostcode);
		    driver.findElement(By.id(pvpostsafe)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "18-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("Duty to Notify (DtN) sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    
		    driver.quit();
		   
		}
	 }  
    
  @Test
  public void child1() throws Exception {
	String projectName = "MS_Test";
    String screenName;
 	
	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "child1");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	//System.out.println("rowcount " + rowNumbers + " last column " + columnLast + "test name" + testName);
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
		    driver = new ChromeDriver();
		    js = (JavascriptExecutor) driver;
		    vars = new HashMap<String, Object>();	
		    String testName = "Child1." + line + "Chrome";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String slocalauthority = ExcelUtil.getCellData(line, 3);
			String slaphone = ExcelUtil.getCellData(line, 4);
			String slaemail = ExcelUtil.getCellData(line, 5);
			String slafirstname = ExcelUtil.getCellData(line, 6);
			String slalastname = ExcelUtil.getCellData(line, 7);
			String saccount = ExcelUtil.getCellData(line, 8);
			String swherecountry = ExcelUtil.getCellData(line, 9);
			String swherenonukother = ExcelUtil.getCellData(line, 10);
			String scurrentukcity = ExcelUtil.getCellData(line, 11);
			String scurrentukregion = ExcelUtil.getCellData(line, 12);
			String swhoex = ExcelUtil.getCellData(line, 13);
			String sotherdetails = ExcelUtil.getCellData(line, 14);
			String spoliceforce = ExcelUtil.getCellData(line, 15);
			String scrimeref = ExcelUtil.getCellData(line, 16);
			String spvfirst = ExcelUtil.getCellData(line, 17);
			String spvlast = ExcelUtil.getCellData(line, 18);
			String spvalias = ExcelUtil.getCellData(line, 19);
			String sdobday = ExcelUtil.getCellData(line, 20);
			String sdobmonth = ExcelUtil.getCellData(line, 21);
			String sdobyear = ExcelUtil.getCellData(line, 22);
			String schildamount = ExcelUtil.getCellData(line, 23);
			String snationality = ExcelUtil.getCellData(line, 24);
			String snationality2 = ExcelUtil.getCellData(line, 25);
			String slanguage = ExcelUtil.getCellData(line, 26);
			String saidtype = ExcelUtil.getCellData(line, 27);
			String shorefnum = ExcelUtil.getCellData(line, 28);
			String sfrfirst = ExcelUtil.getCellData(line, 29);
			String sfrlast = ExcelUtil.getCellData(line, 30);
			String sfrrole = ExcelUtil.getCellData(line, 31);
			String sfrphone = ExcelUtil.getCellData(line, 32);
			String salternate = ExcelUtil.getCellData(line, 33);
			
		    
			try{
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(under18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-LocalAuthority";
		    driver.findElement(By.id(localauthority)).sendKeys(slocalauthority);
		    driver.findElement(By.id(laphone)).sendKeys(slaphone);
		    driver.findElement(By.id(laemail)).sendKeys(slaemail);
		    driver.findElement(By.id(lafirstname)).sendKeys(slafirstname);
		    driver.findElement(By.id(lalastname)).sendKeys(slalastname);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(wherenonuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-WhereOverseas";
		    driver.findElement(By.id(wherecountry)).sendKeys(swherecountry);
		    driver.findElement(By.id(wherenonukother)).sendKeys(swherenonukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(commitfraud)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(otherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVName";
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVDoB";
		    driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVGender";
		    driver.findElement(By.id(unknown)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVChildren";
		    driver.findElement(By.id(children)).click();
		    driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
//		    driver.findElement(By.xpath("//span/div/div/div")).click();
//		    driver.findElement(By.xpath("//summary/span")).click();
//		    driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVInterpreter";
		    driver.findElement(By.id(interpreter)).click();
		    driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-Communication";
		    driver.findElement(By.id(commaid)).click();
		    driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-HORef";
		    driver.findElement(By.id(horef)).click();
		    driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22-FRDetails";
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Alternate";
		    driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "25-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    driver.quit();
		   
		}
	 }
  @Test
  public void child2() throws Exception {
	String projectName = "MS_Test";
    String screenName;
 	
	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "child2");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	//System.out.println("rowcount " + rowNumbers + " last column " + columnLast + "test name" + testName);
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.chrome.driver", "/Users/Bean/Desktop/Selenium/chromedriver");
		    driver = new ChromeDriver();
		    js = (JavascriptExecutor) driver;
		    vars = new HashMap<String, Object>();		
		    String testName = "Child2." + line + "Chrome";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String slocalauthority = ExcelUtil.getCellData(line, 3);
			String slaphone = ExcelUtil.getCellData(line, 4);
			String slaemail = ExcelUtil.getCellData(line, 5);
			String slafirstname = ExcelUtil.getCellData(line, 6);
			String slalastname = ExcelUtil.getCellData(line, 7);
			String saccount = ExcelUtil.getCellData(line, 8);
			String sukcity = ExcelUtil.getCellData(line, 9);
			String sukcity2 = ExcelUtil.getCellData(line, 10);
			String sukcity3 = ExcelUtil.getCellData(line, 11);
			String sukcity4 = ExcelUtil.getCellData(line, 12);
			String sukcity5 = ExcelUtil.getCellData(line, 13);
			String sukcity6 = ExcelUtil.getCellData(line, 14);
			String sukcity7 = ExcelUtil.getCellData(line, 15);
			String sukcity8 = ExcelUtil.getCellData(line, 16);
			String sukcity9 = ExcelUtil.getCellData(line, 17);
			String sukcity10 = ExcelUtil.getCellData(line, 18);
			String sukother = ExcelUtil.getCellData(line, 19);
			String swherecountry = ExcelUtil.getCellData(line, 20);
			String swherecountry2 = ExcelUtil.getCellData(line, 21);
			String swherecountry3 = ExcelUtil.getCellData(line, 22);
			String swherecountry4 = ExcelUtil.getCellData(line, 23);
			String swherecountry5 = ExcelUtil.getCellData(line, 24);
			String swherecountry6 = ExcelUtil.getCellData(line, 25);
			String swherecountry7 = ExcelUtil.getCellData(line, 26);
			String swherecountry8 = ExcelUtil.getCellData(line, 27);
			String swherecountry9 = ExcelUtil.getCellData(line, 28);
			String swherecountry10 = ExcelUtil.getCellData(line, 29);
			String swherenonukother = ExcelUtil.getCellData(line,30);
			String scurrentukcity = ExcelUtil.getCellData(line, 31);
			String scurrentukregion = ExcelUtil.getCellData(line, 32);
			String swhoex = ExcelUtil.getCellData(line, 33);
			String sotherdetails = ExcelUtil.getCellData(line, 34);
			String spoliceforce = ExcelUtil.getCellData(line, 35);
			String scrimeref = ExcelUtil.getCellData(line, 36);
			String spvfirst = ExcelUtil.getCellData(line, 37);
			String spvlast = ExcelUtil.getCellData(line, 38);
			String spvalias = ExcelUtil.getCellData(line, 39);
			String sdobday = ExcelUtil.getCellData(line, 40);
			String sdobmonth = ExcelUtil.getCellData(line, 41);
			String sdobyear = ExcelUtil.getCellData(line, 42);
			String schildamount = ExcelUtil.getCellData(line, 43);
			String snationality = ExcelUtil.getCellData(line, 44);
			String snationality2 = ExcelUtil.getCellData(line, 45);
			String slanguage = ExcelUtil.getCellData(line, 46);
			String saidtype = ExcelUtil.getCellData(line, 47);
			String shorefnum = ExcelUtil.getCellData(line, 48);
			String sfrfirst = ExcelUtil.getCellData(line, 49);
			String sfrlast = ExcelUtil.getCellData(line, 50);
			String sfrrole = ExcelUtil.getCellData(line, 52);
			String sfrphone = ExcelUtil.getCellData(line, 53);
			String salternate = ExcelUtil.getCellData(line, 54);
			
		    
			try{
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    //Thread.sleep(1000);
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(notsure18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-LocalAuthority";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(localauthority)).sendKeys(slocalauthority);
		    driver.findElement(By.id(laphone)).sendKeys(slaphone);
		    driver.findElement(By.id(laemail)).sendKeys(slaemail);
		    driver.findElement(By.id(lafirstname)).sendKeys(slafirstname);
		    driver.findElement(By.id(lalastname)).sendKeys(slalastname);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    //Thread.sleep(2000);
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(whereboth)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-Whereuk";
		    driver.findElement(By.id(whereukcity)).sendKeys(sukcity);
		    driver.findElement(By.id(whereukcity2)).sendKeys(sukcity2);
		    driver.findElement(By.id(whereukcity3)).sendKeys(sukcity3);
		    driver.findElement(By.id(whereukcity4)).sendKeys(sukcity4);
		    driver.findElement(By.id(whereukcity5)).sendKeys(sukcity5);
		    driver.findElement(By.id(whereukcity6)).sendKeys(sukcity6);
		    driver.findElement(By.id(whereukcity7)).sendKeys(sukcity7);
		    driver.findElement(By.id(whereukcity8)).sendKeys(sukcity8);
		    driver.findElement(By.id(whereukcity9)).sendKeys(sukcity9);
		    driver.findElement(By.id(whereukcity10)).sendKeys(sukcity10);
		    driver.findElement(By.id(whereukother)).sendKeys(sukother);
	        Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.2-WhereOverseas";
		    driver.findElement(By.id(wherecountry)).sendKeys(swherecountry);
		    driver.findElement(By.id(wherecountry2)).sendKeys(swherecountry2);
		    driver.findElement(By.id(wherecountry3)).sendKeys(swherecountry3);
		    driver.findElement(By.id(wherecountry4)).sendKeys(swherecountry4);
		    driver.findElement(By.id(wherecountry5)).sendKeys(swherecountry5);
		    driver.findElement(By.id(wherecountry6)).sendKeys(swherecountry6);
		    driver.findElement(By.id(wherecountry7)).sendKeys(swherecountry7);
		    driver.findElement(By.id(wherecountry8)).sendKeys(swherecountry8);
		    driver.findElement(By.id(wherecountry9)).sendKeys(swherecountry9);
		    driver.findElement(By.id(wherecountry10)).sendKeys(swherecountry10);
		    driver.findElement(By.id(wherenonukother)).sendKeys(swherenonukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    Thread.sleep(1000);
		    driver.findElement(By.id(forcework)).click();
		    driver.findElement(By.id(wagestaken)).click();
		    driver.findElement(By.id(commitfraud)).click();
		    driver.findElement(By.id(prostitution)).click();
		    driver.findElement(By.id(childexp)).click();
		    driver.findElement(By.id(taken)).click();
		    driver.findElement(By.id(commitcrime)).click();
		    driver.findElement(By.id(organs)).click();
		    driver.findElement(By.id(unpaid)).click();
		    driver.findElement(By.id(other)).click();
		    driver.findElement(By.id(otherdetails)).sendKeys(sotherdetails); 
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(notsureotherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    Thread.sleep(1000);
		    driver.findElement(By.id(policeyes)).click();
		    driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVName";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVDoB";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVGender";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(male)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVChildren";
		    Thread.sleep(1000);
		    driver.findElement(By.id(nochildren)).click();
		    //driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVNationality";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
  		    //driver.findElement(By.xpath("//span/div/div/div")).click();
  		    //driver.findElement(By.xpath("//summary/span")).click();
  		    driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVInterpreter";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(interpreter)).click();
		    driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-Communication";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(commaid)).click();
		    driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-HORef";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(horef)).click();
		    driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22-FRDetails";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Alternate";
		    //Thread.sleep(1000);
		    driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-CYA";
		    //Thread.sleep(3000);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "25-subcomplete";
		    //Thread.sleep(3000);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    driver.quit();
		   
		}
	 }
  @Test
  public void child3() throws Exception {
	String projectName = "MS_Test";
    String screenName;
 	
	ExcelUtil.setExcelFile(ExcelUtil.Path_TestData + ExcelUtil.File_TestData, "child3");
	int columnLast = ExcelUtil.lastColumn;
	int rowNumbers = ExcelUtil.rowCount;
	//System.out.println("rowcount " + rowNumbers + " last column " + columnLast + "test name" + testName);
	String columnResult = dateFormat.format(date);
	ExcelUtil.setCellData(columnResult, 0, columnLast);
	
	//Add referrals loop
		for(int line = 1; line<=rowNumbers; line++){
			
			System.setProperty("webdriver.gecko.driver", "/Users/Bean/Desktop/Selenium/geckodriver");
			FirefoxOptions firefoxOptions = new FirefoxOptions();
		    firefoxOptions.setCapability("marionette", true);
		    driver = new FirefoxDriver(firefoxOptions);		
		    String testName = "Child3." + line + "Firefox";
		    String imagePath = ".." + fileSeparator + "Results_Screenshots" + fileSeparator + projectName + fileSeparator + dateFormat2.format(date) + fileSeparator + dateFormat3.format(date) + fileSeparator + testName;
			
		    //define data to be entered from spreadsheet
			String snrmurl = ExcelUtil.getCellData(line, 1);
			String sfrloc = ExcelUtil.getCellData(line, 2);
			String slocalauthority = ExcelUtil.getCellData(line, 3);
			String slaphone = ExcelUtil.getCellData(line, 4);
			String slaemail = ExcelUtil.getCellData(line, 5);
			String slafirstname = ExcelUtil.getCellData(line, 6);
			String slalastname = ExcelUtil.getCellData(line, 7);
			String saccount = ExcelUtil.getCellData(line, 8);
			String swherecountry = ExcelUtil.getCellData(line, 9);
			String swherenonukother = ExcelUtil.getCellData(line, 10);
			String scurrentukcity = ExcelUtil.getCellData(line, 11);
			String scurrentukregion = ExcelUtil.getCellData(line, 12);
			String swhoex = ExcelUtil.getCellData(line, 13);
			String sotherdetails = ExcelUtil.getCellData(line, 14);
			String spoliceforce = ExcelUtil.getCellData(line, 15);
			String scrimeref = ExcelUtil.getCellData(line, 16);
			String spvfirst = ExcelUtil.getCellData(line, 17);
			String spvlast = ExcelUtil.getCellData(line, 18);
			String spvalias = ExcelUtil.getCellData(line, 19);
			String sdobday = ExcelUtil.getCellData(line, 20);
			String sdobmonth = ExcelUtil.getCellData(line, 21);
			String sdobyear = ExcelUtil.getCellData(line, 22);
			String schildamount = ExcelUtil.getCellData(line, 23);
			String snationality = ExcelUtil.getCellData(line, 24);
			String snationality2 = ExcelUtil.getCellData(line, 25);
			String slanguage = ExcelUtil.getCellData(line, 26);
			String saidtype = ExcelUtil.getCellData(line, 27);
			String shorefnum = ExcelUtil.getCellData(line, 28);
			String sfrfirst = ExcelUtil.getCellData(line, 29);
			String sfrlast = ExcelUtil.getCellData(line, 30);
			String sfrrole = ExcelUtil.getCellData(line, 31);
			String sfrphone = ExcelUtil.getCellData(line, 32);
			String salternate = ExcelUtil.getCellData(line, 33);
			
		    
			try{
		    driver.get(snrmurl);
		    driver.manage().window().setSize(new Dimension(1440, 877));
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "2-FRLocation";
		    frloc = sfrloc;
		    driver.findElement(By.id(frloc)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "3-Under18";
		    driver.findElement(By.id(under18)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "4-LocalAuthority";
		    driver.findElement(By.id(localauthority)).sendKeys(slocalauthority);
		    driver.findElement(By.id(laphone)).sendKeys(slaphone);
		    driver.findElement(By.id(laemail)).sendKeys(slaemail);
		    driver.findElement(By.id(lafirstname)).sendKeys(slafirstname);
		    driver.findElement(By.id(lalastname)).sendKeys(slalastname);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
			driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "5-VictimAccount";
		    driver.findElement(By.id(account)).sendKeys(saccount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6-Where";
		    driver.findElement(By.id(wherenonuk)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "6.1-WhereOverseas";
		    driver.findElement(By.id(wherecountry)).sendKeys(swherecountry);
		    driver.findElement(By.id(wherenonukother)).sendKeys(swherenonukother);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "7-currentLocation";
		    driver.findElement(By.id(currentukcity)).sendKeys(scurrentukcity);
		    driver.findElement(By.id(currentukregion)).sendKeys(scurrentukregion);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "8-Exploiter";
		    driver.findElement(By.id(whoex)).sendKeys(swhoex);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "9-Exploitation";
		    driver.findElement(By.id(prostitution)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "10-OtherPV";
		    driver.findElement(By.id(nootherpv)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "11-PoliceReport";
		    driver.findElement(By.id(policeno)).click();
		    //driver.findElement(By.id(policeforce)).sendKeys(spoliceforce);
		    //driver.findElement(By.id(crimeref)).sendKeys(scrimeref);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "13-PVName";
		    driver.findElement(By.id(pvfirst)).sendKeys(spvfirst);
		    driver.findElement(By.id(pvlast)).sendKeys(spvlast);
		    //driver.findElement(By.id(pvalias)).sendKeys(spvalias);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "14-PVDoB";
		    //driver.findElement(By.id(dobday)).sendKeys(sdobday);
		    //driver.findElement(By.id(dobmonth)).sendKeys(sdobmonth);
		    //driver.findElement(By.id(dobyear)).sendKeys(sdobyear);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "15-PVGender";
		    driver.findElement(By.id(male)).click();
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "16-PVChildren";
		    driver.findElement(By.id(nochildren)).click();
		    //driver.findElement(By.id(childamount)).sendKeys(schildamount);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "17-PVNationality";
		    driver.findElement(By.id(nationality)).sendKeys(snationality);
//		    driver.findElement(By.xpath("//span/div/div/div")).click();
//		    driver.findElement(By.xpath("//summary/span")).click();
//		    driver.findElement(By.id(nationality2)).sendKeys(snationality2);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "18-PVInterpreter";
		    driver.findElement(By.id(nointerpreter)).click();
		    //driver.findElement(By.id(language)).sendKeys(slanguage);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "19-Communication";
		    driver.findElement(By.id(nocommaid)).click();
		    //driver.findElement(By.id(aidtype)).sendKeys(saidtype);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "20-HORef";
		    driver.findElement(By.id(nohoref)).click();
		    //driver.findElement(By.id(horefnum)).sendKeys(shorefnum);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "22-FRDetails";
		    driver.findElement(By.id(frfirst)).sendKeys(sfrfirst);
		    driver.findElement(By.id(frlast)).sendKeys(sfrlast);
		    driver.findElement(By.id(frrole)).sendKeys(sfrrole);
		    driver.findElement(By.id(frphone)).sendKeys(sfrphone);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "23-Alternate";
		    //driver.findElement(By.id(alternate)).sendKeys(salternate);
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector(".button")).click();
		    
		    screenName = "24-CYA";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    driver.findElement(By.cssSelector("input[value^='Accept']")).click();
		    
		    screenName = "25-subcomplete";
		    Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName(screenName).save(imagePath);
		    
		    
		    System.out.println(driver.findElement(By.cssSelector(".govuk-panel__title")).getText());
	    	  assertTrue(driver.findElement(By.cssSelector(".govuk-panel__title")).getText().contains("NRM referral sent"));
		      testResult = (testName + " - Submission completed correctly");
	    	  System.out.println(testResult);
	    	  Utility.Utilitylog(logFile, testResult);
		    }
		    catch(Throwable pageNavigationError) {
		      Shutterbug.shootPage(driver,ScrollStrategy.BOTH_DIRECTIONS,500,true).withName("error" + testName).save(imagePath);
		      testResult = (testName + " - Submission did not complete correctly");
		      System.out.println(testResult);
		      Utility.Utilitylog(logFile, testResult);
		    
		    }
		    driver.quit();
		   
		}
	 }
  
}